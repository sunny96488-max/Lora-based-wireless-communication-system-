#include <Adafruit_GFX.h>
#include <Adafruit_ILI9341.h>
#include <DHT.h>

// ---------- TFT PINS ----------
#define TFT_CS   15
#define TFT_DC   2
#define TFT_RST  4

Adafruit_ILI9341 tft = Adafruit_ILI9341(TFT_CS, TFT_DC, TFT_RST);

// ---------- DHT22 ----------
#define DHTPIN 27
#define DHTTYPE DHT22
DHT dht(DHTPIN, DHTTYPE);

void setup() {
  Serial.begin(115200);

  // Initialize TFT
  tft.begin();
  tft.setRotation(1);
  tft.fillScreen(ILI9341_BLACK);

  // Initialize DHT
  dht.begin();

  // Welcome Screen
  tft.setTextColor(ILI9341_CYAN);
  tft.setTextSize(2);
  tft.setCursor(20, 40);
  tft.println("LoRa Monitoring");

  tft.setTextColor(ILI9341_WHITE);
  tft.setCursor(20, 80);
  tft.println("ESP32 + DHT22");

  tft.setCursor(20, 120);
  tft.println("Status: ACTIVE");

  delay(2000);
}

void loop() {
  float temperature = dht.readTemperature();
  float humidity = dht.readHumidity();

  tft.fillScreen(ILI9341_BLACK);

  tft.setTextColor(ILI9341_YELLOW);
  tft.setTextSize(2);
  tft.setCursor(20, 20);
  tft.println("Power System Node");

  tft.setTextColor(ILI9341_WHITE);
  tft.setCursor(20, 70);
  tft.print("Temperature: ");
  tft.print(temperature);
  tft.println(" C");

  tft.setCursor(20, 110);
  tft.print("Humidity   : ");
  tft.print(humidity);
  tft.println(" %");

  tft.setTextColor(ILI9341_GREEN);
  tft.setCursor(20, 160);
  tft.println("Node Status: OK");

  delay(2000);
}
